{{>layout/header}}
<style>
    .form-group .bmd-label-static {
        color: darkblue;
        top: -10px;
        position: initial;
        justify-content: center;
        align-items: center;
        display: flex;
        margin-left: 0px;
    }

    .table .popthead tr th {
        font-size: 0.875rem;
        color: darkblue;
        font-weight: bolder;
    }

    .table .popthead td {
        font-size: 0.875rem;
        color: darkblue;
        font-weight: bolder;
    }
</style>

<div class="content" id="context">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-primary">
                        <div style="float: left">
                            <h4 class="card-title ">{{#messages}}menu.transaction{{/messages}}</h4>
                            <p class="card-category">{{#messages}}menu.transaction{{/messages}} management</p>
                        </div>
                        <div style="float: right">
                            <form class="form-inline ml-auto" id="TransactionSearchForm" action=""
                                  onsubmit="return false;">
                                <input type="hidden" name="searchKey" value=""/>
                                <input type="button" id="step1" name="step1" value="QRstep1"/>
                                <input type="button" id="step2" name="step2" value="check Transaction state"/>
                                <input type="button" id="step3" name="step3" value="QRsetp2"/>
                                <input type="button" id="step4" name="step4" value="mobileDirectPay"/>
                                <div class="dropdown" style="margin-right: 10px;">
                                    <button class="btn btn-secondary dropdown-toggle" type="button"
                                            id="dropdownMenuButton-transaction-search" data-toggle="dropdown"
                                            aria-haspopup="true" aria-expanded="false">
                                        userId
                                    </button>
                                    <div id="transaction-search-field" class="dropdown-menu"
                                         aria-labelledby="dropdownMenuButton-transaction-search">
                                        <a class="dropdown-item" href="#none" searchKey="userId">userId</a>
                                        <a class="dropdown-item" href="#none" searchKey="merchantId">merchantId</a>
                                        <a class="dropdown-item" href="#none" searchKey="paymentType">paymentType</a>
                                        <a class="dropdown-item" href="#none" searchKey="point">point</a>
                                        <a class="dropdown-item" href="#none" searchKey="state">state</a>
                                        <a class="dropdown-item" href="#none" searchKey="type">type</a>
                                    </div>
                                </div>

                                <div class="col has-white">
                                    <input id="searchValue" name="searchValue" type="text" value="" class="form-control"
                                           placeholder="Search" style="color: whitesmoke">
                                </div>
                                <button type="button" class="btn btn-white btn-round btn-just-icon" id="search"
                                        name="search">
                                    <i class="material-icons">search</i>
                                    <div class="ripple-container"></div>
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="card-body">
                        <div class="table-responsive" id="result1">
                            <table class="table" id="templ1">
                                <thead class=" text-primary text-center">
                                <th>NO</th>
                                <th>USERID</th>
                                <th>MERCHANTID</th>
                                <th>PAYMENTTYPE</th>
                                <th>POINT</th>
                                <th>STATE</th>
                                <th>TYPE</th>
                                <th>CREATEDDATE</th>
                                <th>MODIFIEDDATE</th>
                                <th>ACTIONS</th>
                                </thead>
                                <tbody id="transactions" class="text-center"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div>
                    <nav aria-label="Page navigation">
                        <ul id="transactionsPagingArea" class="pagination justify-content-center"></ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="transactionDetailModal" tabindex="-1" role="">
    <div class="modal-dialog modal-login" role="document" style="max-width: 800px;margin-top: 160px;">
        <div class="modal-content">
            <div class="card card-signup card-plain" style="margin-top: 0;margin-bottom: 0">
                <div class="modal-header" style="padding-top: 0;">
                    <div class="card-header card-header-primary text-center" style="width: 100%">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            <i class="material-icons">clear</i>
                        </button>
                        <h4 class="card-title" id="modalTitle">Transaction Detail</h4>
                    </div>
                </div>
                <div class="modal-body">
                    <form class="form" method="" action="">
                        <div class="card-body">
                            <div class="form-row text-center">
                                <div class="form-group col-md-3">
                                    <label for="inputTransactionId">NO</label>
                                    <input type="text" class="form-control text-center" id="TransactionId"
                                           name="TransactionId" placeholder="ex> TransactionId" disabled>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="inputUserId">userId</label>
                                    <input type="text" class="form-control text-center" id="BuyerId" name="BuyerId"
                                           placeholder="ex> BuyerId" disabled>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="inputMerchantId">MerchantId</label>
                                    <input type="text" class="form-control text-center" id="MerchantId"
                                           name="MerchantId" placeholder="ex> MerchantId" disabled>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="inputPaymentType">PaymentType</label>
                                    <input type="text" class="form-control text-center" id="PaymentType"
                                           name="PaymentType" placeholder="ex> TransactionId" disabled>
                                </div>
                            </div>

                            <div class="form-row text-center">
                                <div class="form-group col-md-3">
                                    <label for="inputPoint">TransactionPoint</label>
                                    <input type="text" class="form-control text-right" id="TransactionPoint"
                                           name="TransactionPoint" placeholder="ex> BuyerId" disabled>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="inputState">TransactionState</label>
                                    <input type="text" class="form-control text-center" id="TransactionState"
                                           name="TransactionState" placeholder="ex> MerchantId" disabled>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="inputType">TransactionType</label>
                                    <input type="text" class="form-control text-center" id="TransactionType"
                                           name="TransactionType" placeholder="ex> MerchantId" disabled>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="inputCity">Barcode</label>
                                    <input type="text" class="form-control text-center" id="barcode" name="barcode"
                                           placeholder="ex> MerchantId" disabled>
                                </div>
                            </div>

                            <div class="form-group"></div>
                            <table class="table" id="templ1">
                                <thead class=" text-primary text-center popthead">
                                <th>productName</th>
                                <th>amount</th>
                                <th>point</th>
                                </thead>
                                <tbody id="transactionItems" class="text-center"></tbody>
                                <table id="totalPoint" class="table text-center"></table>
                            </table>

                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script id="transactionsTemplate" type="text/x-jquery-tmpl">
<tr>
   <td style='display:none;position:absolute'>${id}</td>
   <td>${number}</td>
   <td style='display: none'>${id}</td>
   // User -> Transaction 관계 임시 해제를 위한 주석
<!--   <td>${user.username}</td>-->
   <td>${userId}</td>
   <td>${merchantId}</td>
   <td>${paymentType}</td>
   <td class='text-right'>${point}</td>
   <td>${state}</td>
   <td>${type}</td>
   <td>${createdDate}</td>
   <td>${modifiedDate}</td>
   <td class='td-actions text-center'>
        <button type='button' rel='tooltip' class='btn btn-success' name='details'>
            <i class='material-icons' data-toggle='modal' data-target='#addUpdateModal'>find_in_page</i>
        </button>
   {%if state == "SUCCESS"%}
        <button type='button' rel='tooltip' class='btn btn-danger' name='refund'>
            <i class='material-icons'>close</i>
        </button>
   {%/if%}
   </td>
</tr>

</script>
<script id="transactionsNoDataTemplate" type="text/x-jquery-tmpl">
<tr>
    <td colspan="10">No Data.</td>
</tr>

</script>
<script id="transactionsItemsTemplate" type="text/x-jquery-tmpl">
<tr>
    <td>${productName}</td>
    <td>${productQuantity}</td>
    <td class='text-right'>${productPoint}</td>
</tr>

</script>
<script id="transactionsItemsNoDataTemplate" type="text/x-jquery-tmpl">
<tr>
    <td colspan="3">No Data.</td>
</tr>

</script>
<script id="transactionsItemsTotalPointTemplate" type="text/x-jquery-tmpl">
<tr class='popthead' style='border: #9e9e9e 1px solid'>
    <td> SUMMERIZE :</td>
    <td colspan=2 class='text-right'>${totalPoint}</td>
</tr>

</script>
<script id="transactionsPagingTemplate" type="text/x-jquery-tmpl">
<li class="page-item">
    <a class="page-link" href="#none">${page}</a>
</li>

</script>

<script type="text/javascript" src="/js/plugins/jquery.tmpl.js"></script>
<script type="text/javascript" src="/js/transaction.js"></script>

{{>layout/footer}}