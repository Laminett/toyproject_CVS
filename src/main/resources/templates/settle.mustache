{{>layout/header}}
<div class="content" id="context">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
             <input type="hidden" id="loginUser" value="{{loginUser}}">
                <div class="card">
                    <div class="card-header card-header-primary">
                        <div style="float: left">
                            <h4 class="card-title">{{#messages}}menu.settle{{/messages}}</h4>
                        </div>

                        <div style="float: right">
                            <form class="form-inline ml-auto" id="settleSearchForm">
                                <span>{{#messages}}settle.aggregated.at{{/messages}}</span>
                                <div class="form-group has-white">
                                    <input type="text" class="form-control monthpicker" id="search_date">
                                </div>
                                <span>{{#messages}}user.full.name{{/messages}}</span>
                                <div class="form-group has-white">
                                    <input type="text" class="form-control" id="search_fullName" maxlength="25" style="color: white;">
                                </div>
                                <button type="button" class="btn btn-white btn-round btn-just-icon" id="btn_search">
                                    <i class="material-icons">search</i>
                                </button>
                            </form>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr class="text-center text-primary">
                                        <th>#</th>
                                        <th>{{#messages}}username{{/messages}}</th>
                                        <th>{{#messages}}user.full.name{{/messages}}</th>
                                        <th>{{#messages}}settle.aggregated.at{{/messages}}</th>
                                        <th>{{#messages}}approval.count{{/messages}}</th>
                                        <th>{{#messages}}approval.amount{{/messages}}</th>
                                        <th>{{#messages}}cancel.count{{/messages}}</th>
                                        <th>{{#messages}}cancel.amount{{/messages}}</th>
                                        <th>{{#messages}}settle.total.count{{/messages}}</th>
                                        <th>{{#messages}}settle.total.amount{{/messages}}</th>
                                        <th>{{#messages}}settle.modified.date{{/messages}}</th>
                                        <th>{{#messages}}status{{/messages}}</th>
                                    </tr>
                                </thead>
                                <tbody id="settleArea"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div>
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center"></ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>
<script id="settleTemplate" type="text/x-jquery-tmpl">
<tr id='${id}'>
    <td class='text-center'>${id}</td>
    <td class='text-left'>${username}</td>
    <td class="text-left">${fullName}</td>
    <td class='text-center'>${aggregatedAt}</td>
    <td class='text-center'>${approvalCount}</td>
    <td class='text-right'>${approvalAmount}</td>
    <td class='text-center'>${cancelCount}</td>
    <td class='text-right'>${cancelAmount}</td>
    <td class='text-center'>${totalCount}</td>
    <td class='text-right'>${totalAmount}</td>
    <td class='text-center'>${modifiedDate}</td>
{%if status%}
    {%if status == 'Y'%}
        <td class="text-left">Approved by ${adminId}</td>
    {%else%}
        <td class="text-left">Denied by ${adminId}</td>
    {%/if%}
{%else%}
    <td class='td-actions text-center'>
        <button type='button' class='btn btn-info' name='btn_approve' value='Y'>
            <i class='material-icons'>done</i>
        </button>&nbsp;
        <button type='button' class='btn btn-danger' name='btn_deny' value='N'>
            <i class='material-icons'>clear</i>
        </button>
    </td>
{%/if%}
</script>
<script>
   var messages = {
       "info.search.no.data": "{{#messages}}info.search.no.data{{/messages}}"
       ,"alert.load.fail": "{{#messages}}alert.load.fail{{/messages}}"
       ,"alert.settle.confirm": "{{#messages}}alert.settle.confirm{{/messages}}"
       ,"alert.update.success": "{{#messages}}alert.update.success{{/messages}}"
       ,"alert.update.fail": "{{#messages}}alert.update.fail{{/messages}}"
   };
</script>
<link rel="stylesheet" href="/datepicker/bootstrap-monthpicker.css">
<script type="text/javascript" src="/datepicker/bootstrap-monthpicker.js"></script>
<script type="text/javascript" src="/js/plugins/jquery.tmpl.js"></script>
<script type="text/javascript" src="/js/plugins/moment.js"></script>
<script type="text/javascript" src="/js/settle.js"></script>
{{>layout/footer}}